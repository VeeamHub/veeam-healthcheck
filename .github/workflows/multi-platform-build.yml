# name: Multi-Platform Build

# on:
#   push:
#     branches: [ "master", "dev" ]
#   pull_request:
#     branches: [ "master", "dev" ]
#   workflow_dispatch:

# jobs:
#   build:
#     strategy:
#       matrix:
#         os: [windows-latest, ubuntu-latest]
#         config: [Debug, Release]
#         exclude:
#           # Skip Ubuntu Debug builds to save CI time
#           - os: ubuntu-latest
#             config: Debug
#       fail-fast: false
      
#     runs-on: ${{ matrix.os }}
    
#     name: Build on ${{ matrix.os }} (${{ matrix.config }})
    
#     steps:
#       - name: Checkout repository
#         uses: actions/checkout@v4

#       - name: Setup .NET
#         uses: actions/setup-dotnet@v4
#         with:
#           dotnet-version: '8.0.x'

#       - name: Restore dependencies
#         run: dotnet restore vHC/HC.sln

#       - name: Build solution
#         run: dotnet build vHC/HC.sln --configuration ${{ matrix.config }} --no-restore

#       - name: Run tests (Windows only)
#         if: matrix.os == 'windows-latest'
#         run: |
#           dotnet test vHC/HC.sln --configuration ${{ matrix.config }} --no-build --verbosity normal --logger "trx;LogFileName=test-results-${{ matrix.os }}-${{ matrix.config }}.trx"

#       - name: Check for build warnings
#         shell: pwsh
#         run: |
#           $buildLog = "build-${{ matrix.os }}-${{ matrix.config }}.log"
#           dotnet build vHC/HC.sln --configuration ${{ matrix.config }} --no-restore > $buildLog 2>&1
          
#           $warnings = Select-String -Path $buildLog -Pattern "warning CS" | Measure-Object
          
#           echo "## ðŸ” Build Analysis (${{ matrix.os }}, ${{ matrix.config }})" >> $env:GITHUB_STEP_SUMMARY
#           echo "" >> $env:GITHUB_STEP_SUMMARY
#           echo "**Warnings:** $($warnings.Count)" >> $env:GITHUB_STEP_SUMMARY
          
#           if ($warnings.Count -gt 100) {
#             echo "::warning::High number of build warnings detected: $($warnings.Count)"
#           }

#       - name: Upload test results (Windows only)
#         if: matrix.os == 'windows-latest' && always()
#         uses: actions/upload-artifact@v4
#         with:
#           name: test-results-${{ matrix.os }}-${{ matrix.config }}
#           path: '**/test-results-${{ matrix.os }}-${{ matrix.config }}.trx'
#           retention-days: 7

#       - name: Upload build artifacts
#         if: success() && matrix.config == 'Release'
#         uses: actions/upload-artifact@v4
#         with:
#           name: build-${{ matrix.os }}-${{ matrix.config }}
#           path: |
#             vHC/HC_Reporting/bin/${{ matrix.config }}/net8.0-windows7.0/win-x64/
#           retention-days: 7

#   compatibility-check:
#     needs: build
#     runs-on: ubuntu-latest
#     steps:
#       - name: Compatibility Report
#         run: |
#           echo "## âœ… Multi-Platform Build Results" >> $GITHUB_STEP_SUMMARY
#           echo "" >> $GITHUB_STEP_SUMMARY
#           echo "All platform builds completed successfully!" >> $GITHUB_STEP_SUMMARY
#           echo "" >> $GITHUB_STEP_SUMMARY
#           echo "- âœ… Windows (Debug & Release)" >> $GITHUB_STEP_SUMMARY
#           echo "- âœ… Ubuntu (Release)" >> $GITHUB_STEP_SUMMARY
